<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThermoPure - Tomato Genetic Purity Detection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #2e7d32;
            --primary-light: #60ad5e;
            --primary-dark: #005005;
            --secondary: #ff8f00;
            --secondary-light: #ffc046;
            --secondary-dark: #c56000;
            --text-on-primary: #ffffff;
            --text-on-secondary: #000000;
            --background: #f8f9fa;
            --surface: #ffffff;
            --error: #b71c1c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--background);
            color: #333;
            line-height: 1.6;
        }
        
        header {
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            color: var(--text-on-primary);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
        }
        
        .logo-icon {
            margin-right: 10px;
            font-size: 2rem;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            margin-left: 2rem;
        }
        
        .nav-links a {
            color: var(--text-on-primary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .nav-links a:hover {
            color: var(--secondary-light);
        }
        
        .hero {
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%232e7d32" opacity="0.1"/><path d="M0 0L100 100" stroke="%232e7d32" stroke-width="1" opacity="0.1"/><path d="M100 0L0 100" stroke="%232e7d32" stroke-width="1" opacity="0.1"/></svg>');
            background-color: var(--surface);
            padding: 4rem 2rem;
            text-align: center;
        }
        
        .hero h1 {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            color: var(--primary-dark);
        }
        
        .hero p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 2rem;
            color: #555;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--secondary);
            color: var(--text-on-secondary);
            padding: 0.8rem 1.8rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn:hover {
            background-color: var(--secondary-dark);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-secondary {
            background-color: var(--primary);
            color: var(--text-on-primary);
        }
        
        .btn-secondary:hover {
            background-color: var(--primary-dark);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            color: var(--primary-dark);
            position: relative;
        }
        
        .section-title::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background-color: var(--secondary);
            margin: 10px auto;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }
        
        .feature-card {
            background-color: var(--surface);
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
        }
        
        .feature-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        
        .feature-card h3 {
            margin-bottom: 1rem;
            color: var(--primary-dark);
        }
        
        .demo {
            background-color: var(--surface);
            padding: 4rem 2rem;
            text-align: center;
        }
        
        .upload-area {
            border: 2px dashed var(--primary-light);
            border-radius: 10px;
            padding: 3rem;
            margin: 2rem auto;
            max-width: 600px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            border-color: var(--primary);
            background-color: rgba(46, 125, 50, 0.05);
        }
        
        .upload-icon {
            font-size: 4rem;
            color: var(--primary-light);
            margin-bottom: 1rem;
        }
        
        .results {
            display: none;
            margin-top: 2rem;
            padding: 2rem;
            background-color: var(--surface);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .result-images {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .result-box {
            flex: 1;
            min-width: 250px;
        }
        
        .result-images img {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .analysis-result {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: 8px;
            background-color: #e8f5e9;
        }
        
        .purity-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            background-color: var(--primary);
            color: white;
            font-weight: bold;
            margin-top: 1rem;
        }
        
        .report-actions {
            margin-top: 2rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            background-color: var(--error);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: none;
        }
        
        .analysis-details {
            margin-top: 2rem;
            text-align: left;
        }
        
        .analysis-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        .analysis-table th, .analysis-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .analysis-table th {
            background-color: rgba(46, 125, 50, 0.1);
        }
        
        .sample-images {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        
        .sample-image {
            width: 150px;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .sample-image:hover {
            transform: scale(1.05);
        }
        
        footer {
            background-color: var(--primary-dark);
            color: var(--text-on-primary);
            padding: 3rem 2rem;
            text-align: center;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            text-align: left;
        }
        
        .footer-section h3 {
            margin-bottom: 1.5rem;
            position: relative;
        }
        
        .footer-section h3::after {
            content: '';
            display: block;
            width: 50px;
            height: 2px;
            background-color: var(--secondary);
            margin-top: 10px;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 0.8rem;
        }
        
        .footer-links a {
            color: #e0e0e0;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-links a:hover {
            color: var(--secondary-light);
        }
        
        .copyright {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .hero h1 {
                font-size: 2.2rem;
            }
            
            .features {
                grid-template-columns: 1fr;
            }
            
            .report-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .sample-images {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <header>
        <nav>
            <div class="logo">
                <span class="logo-icon">üå°Ô∏è</span>
                ThermoPure
            </div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#technology">Technology</a></li>
                <li><a href="#demo">Demo</a></li>
                <li><a href="#applications">Applications</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <section class="hero" id="home">
        <h1>Revolutionizing Tomato Genetic Purity Detection</h1>
        <p>Using advanced thermal imaging and AI to ensure the genetic purity of tomato seeds and seedlings with non-destructive, rapid analysis.</p>
        <a href="#demo" class="btn">Try Demo</a>
    </section>

    <section class="container" id="technology">
        <h2 class="section-title">How It Works</h2>
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">üì∑</div>
                <h3>Thermal Imaging</h3>
                <p>Specialized thermal cameras capture heat patterns emitted by seeds and seedlings, which vary based on genetic makeup.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ü§ñ</div>
                <h3>AI Analysis</h3>
                <p>Machine learning algorithms analyze thermal signatures to detect anomalies indicating genetic impurities.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üìä</div>
                <h3>Detailed Reporting</h3>
                <p>Comprehensive reports provide purity percentages, anomaly locations, and recommendations for action.</p>
            </div>
        </div>
    </section>

    <section class="demo" id="demo">
        <h2 class="section-title">Try Our Demo</h2>
        <p>Upload a thermal image of tomato seeds or seedlings to analyze genetic purity</p>
        
        <div class="upload-area" id="dropZone">
            <div class="upload-icon">üì§</div>
            <p>Drag & drop a thermal image here or click to browse</p>
            <p class="upload-note">Note: Only thermal images with temperature data are accepted</p>
            <input type="file" id="fileInput" accept="image/*" style="display: none;">
        </div>
        
        <div class="sample-images">
            <p>Try our sample images: </p>
            <img class="sample-image" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='150' height='150' viewBox='0 0 150 150'><rect width='150' height='150' fill='%23333'/><text x='75' y='75' font-family='Arial' font-size='12' fill='white' text-anchor='middle'>Sample 1 (High Purity)</text></svg>" data-purity="95" alt="Sample 1">
            <img class="sample-image" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='150' height='150' viewBox='0 0 150 150'><rect width='150' height='150' fill='%23333'/><text x='75' y='75' font-family='Arial' font-size='12' fill='white' text-anchor='middle'>Sample 2 (Moderate)</text></svg>" data-purity="87" alt="Sample 2">
            <img class="sample-image" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='150' height='150' viewBox='0 0 150 150'><rect width='150' height='150' fill='%23333'/><text x='75' y='75' font-family='Arial' font-size='12' fill='white' text-anchor='middle'>Sample 3 (Low Purity)</text></svg>" data-purity="78" alt="Sample 3">
        </div>
        
        <div class="results" id="resultsSection">
            <h3>Analysis Results</h3>
            <div class="result-images">
                <div class="result-box">
                    <h4>Original Image</h4>
                    <img id="originalImage" src="" alt="Original thermal image">
                </div>
                <div class="result-box">
                    <h4>Analysis Map</h4>
                    <img id="analysisImage" src="" alt="Analysis result">
                </div>
            </div>
            
            <div class="analysis-result">
                <h4>Genetic Purity Assessment</h4>
                <p>Based on our analysis, this sample shows:</p>
                <p><strong>Purity Confidence: <span id="purityValue">92%</span></strong></p>
                <div class="purity-badge">High Purity</div>
                
                <div class="analysis-details">
                    <h4>Detailed Analysis</h4>
                    <table class="analysis-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Value</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="analysisTableBody">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <p id="recommendationText">Recommendation: Suitable for commercial cultivation and seed production.</p>
            </div>
            
            <div class="report-actions">
                <button class="btn btn-secondary" id="exportExcelBtn">Export to Excel</button>
                <button class="btn" id="newAnalysisBtn">New Analysis</button>
            </div>
        </div>
    </section>

    <section class="container" id="applications">
        <h2 class="section-title">Applications</h2>
        <div class="features">
            <div class="feature-card">
                <h3>Seed Producers</h3>
                <p>Ensure genetic purity of seed batches before distribution to maintain quality standards and brand reputation.</p>
            </div>
            <div class="feature-card">
                <h3>Agricultural Research</h3>
                <p>Non-destructive testing method for breeding programs and genetic studies without damaging valuable specimens.</p>
            </div>
            <div class="feature-card">
                <h3>Quality Control</h3>
                <p>Rapid screening of seedlings at nurseries to prevent the propagation of genetically impure plants.</p>
            </div>
        </div>
    </section>

    <footer id="contact">
        <div class="footer-content">
            <div class="footer-section">
                <h3>ThermoPure</h3>
                <p>Advanced thermal imaging solutions for agricultural genetic purity detection.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#technology">Technology</a></li>
                    <li><a href="#demo">Demo</a></li>
                    <li><a href="#applications">Applications</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Contact Us</h3>
                <p>Email: info@thermopure.com</p>
                <p>Phone: +1 (555) 123-4567</p>
                <p>Address: 123 Innovation Drive, Science Park, CA 94301</p>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2025 ThermoPure. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // File upload functionality
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const resultsSection = document.getElementById('resultsSection');
        const originalImage = document.getElementById('originalImage');
        const analysisImage = document.getElementById('analysisImage');
        const analysisTableBody = document.getElementById('analysisTableBody');
        const exportExcelBtn = document.getElementById('exportExcelBtn');
        const newAnalysisBtn = document.getElementById('newAnalysisBtn');
        const notification = document.getElementById('notification');
        const sampleImages = document.querySelectorAll('.sample-image');
        
        // Click on dropZone to trigger file input
        dropZone.addEventListener('click', () => {
            fileInput.click();
        });
        
        // Handle file selection
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleFile(e.target.files[0]);
            }
        });
        
        // Drag and drop functionality
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = 'var(--primary)';
            dropZone.style.backgroundColor = 'rgba(46, 125, 50, 0.1)';
        });
        
        dropZone.addEventListener('dragleave', () => {
            dropZone.style.borderColor = 'var(--primary-light)';
            dropZone.style.backgroundColor = 'transparent';
        });
        
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            if (e.dataTransfer.files.length) {
                handleFile(e.dataTransfer.files[0]);
            }
            dropZone.style.borderColor = 'var(--primary-light)';
            dropZone.style.backgroundColor = 'transparent';
        });
        
        // Sample image click handler
        sampleImages.forEach(sample => {
            sample.addEventListener('click', () => {
                const purity = sample.getAttribute('data-purity');
                simulateAnalysis(sample.src, purity);
            });
        });
        
        // Show notification
        function showNotification(message, isError = true) {
            notification.textContent = message;
            notification.style.backgroundColor = isError ? 'var(--error)' : 'var(--primary)';
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }
        
        // Check if image is a thermal image (simplified check)
        function isThermalImage(file) {
            // In a real implementation, this would analyze the image metadata
            // For demo purposes, we'll check the file name and type
            const fileName = file.name.toLowerCase();
            
            // Check for common thermal image file names or extensions
            const thermalIndicators = ['thermal', 'ir', 'infrared', 'flir'];
            const isLikelyThermal = thermalIndicators.some(indicator => 
                fileName.includes(indicator)
            );
            
            // Also check if it's an image file
            return file.type.match('image.*') && isLikelyThermal;
        }
        
        // Handle the uploaded file
        function handleFile(file) {
            if (!file.type.match('image.*')) {
                showNotification('Please upload an image file');
                return;
            }
            
            // Check if it's a thermal image
            if (!isThermalImage(file)) {
                showNotification('This does not appear to be a thermal image. Please upload a proper thermal image for analysis.');
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                // For demo purposes, we'll generate a random purity value between 75-98%
                const purity = 75 + Math.floor(Math.random() * 24);
                simulateAnalysis(e.target.result, purity);
            };
            
            reader.readAsDataURL(file);
        }
        
        // Simulate analysis with given image and purity value
        function simulateAnalysis(imageSrc, purity) {
            // Display original image
            originalImage.src = imageSrc;
            
            // Generate analysis visualization based on purity
            let analysisSvg;
            if (purity >= 90) {
                analysisSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300" viewBox="0 0 400 300"><defs><linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:blue;stop-opacity:1" /><stop offset="30%" style="stop-color:green;stop-opacity:1" /><stop offset="100%" style="stop-color:green;stop-opacity:1" /></linearGradient></defs><rect width="400" height="300" fill="url(#grad)"/><text x="200" y="150" font-family="Arial" font-size="20" fill="white" text-anchor="middle">Uniform Thermal Pattern</text></svg>`;
            } else if (purity >= 80) {
                analysisSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300" viewBox="0 0 400 300"><defs><linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:blue;stop-opacity:1" /><stop offset="50%" style="stop-color:green;stop-opacity:1" /><stop offset="70%" style="stop-color:yellow;stop-opacity:1" /><stop offset="100%" style="stop-color:yellow;stop-opacity:1" /></linearGradient></defs><rect width="400" height="300" fill="url(#grad)"/><text x="200" y="150" font-family="Arial" font-size="20" fill="black" text-anchor="middle">Minor Variations Detected</text></svg>`;
            } else {
                analysisSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300" viewBox="0 0 400 300"><defs><linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:blue;stop-opacity:1" /><stop offset="30%" style="stop-color:red;stop-opacity:1" /><stop offset="60%" style="stop-color:yellow;stop-opacity:1" /><stop offset="100%" style="stop-color:red;stop-opacity:1" /></linearGradient></defs><rect width="400" height="300" fill="url(#grad)"/><text x="200" y="150" font-family="Arial" font-size="20" fill="white" text-anchor="middle">Significant Anomalies Detected</text></svg>`;
            }
            
            analysisImage.src = 'data:image/svg+xml;utf8,' + analysisSvg;
            
            // Set purity value
            document.getElementById('purityValue').textContent = `${purity}%`;
            
            // Update badge text based on purity
            const badge = document.querySelector('.purity-badge');
            let recommendation = '';
            
            if (purity >= 90) {
                badge.textContent = 'Excellent Purity';
                badge.style.backgroundColor = 'var(--primary)';
                recommendation = 'Excellent genetic purity. Suitable for elite seed production and commercial cultivation.';
            } else if (purity >= 80) {
                badge.textContent = 'High Purity';
                badge.style.backgroundColor = 'var(--primary-light)';
                recommendation = 'High genetic purity. Suitable for commercial cultivation with minor monitoring recommended.';
            } else if (purity >= 70) {
                badge.textContent = 'Moderate Purity';
                badge.style.backgroundColor = 'var(--secondary)';
                recommendation = 'Moderate genetic purity. Further testing recommended before commercial use.';
            } else {
                badge.textContent = 'Low Purity';
                badge.style.backgroundColor = 'var(--secondary-dark)';
                recommendation = 'Low genetic purity. Not recommended for commercial use without additional purification.';
            }
            
            document.getElementById('recommendationText').textContent = `Recommendation: ${recommendation}`;
            
            // Generate detailed analysis table
            generateAnalysisTable(purity);
            
            // Show results section
            resultsSection.style.display = 'block';
            
            // Scroll to results
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Generate analysis table data
        function generateAnalysisTable(purity) {
            // Clear previous table data
            analysisTableBody.innerHTML = '';
            
            // Generate random but plausible analysis data based on purity
            const parameters = [
                { name: 'Temperature Variance', ideal: 'Low', weight: 0.3 },
                { name: 'Pattern Consistency', ideal: 'High', weight: 0.25 },
                { name: 'Spectral Signature Match', ideal: 'High', weight: 0.2 },
                { name: 'Anomaly Detection', ideal: 'Low', weight: 0.15 },
                { name: 'Growth Potential Index', ideal: 'High', weight: 0.1 }
            ];
            
            parameters.forEach(param => {
                const row = document.createElement('tr');
                
                // Parameter name
                const nameCell = document.createElement('td');
                nameCell.textContent = param.name;
                row.appendChild(nameCell);
                
                // Generate value based on purity and parameter weight
                let value;
                let status;
                
                // Base value affected by purity and parameter weight
                const baseValue = purity * (0.9 + (param.weight * 0.2));
                
                if (param.name === 'Temperature Variance' || param.name === 'Anomaly Detection') {
                    // Lower is better for these parameters
                    value = (100 - baseValue).toFixed(1) + '%';
                    if (baseValue < 85) {
                        status = 'Excellent';
                    } else if (baseValue < 90) {
                        status = 'Good';
                    } else if (baseValue < 95) {
                        status = 'Acceptable';
                    } else {
                        status = 'Review Needed';
                    }
                } else {
                    // Higher is better for these parameters
                    value = baseValue.toFixed(1) + '%';
                    if (baseValue > 95) {
                        status = 'Excellent';
                    } else if (baseValue > 90) {
                        status = 'Good';
                    } else if (baseValue > 85) {
                        status = 'Acceptable';
                    } else {
                        status = 'Needs Improvement';
                    }
                }
                
                const valueCell = document.createElement('td');
                valueCell.textContent = value;
                row.appendChild(valueCell);
                
                const statusCell = document.createElement('td');
                statusCell.textContent = status;
                row.appendChild(statusCell);
                
                analysisTableBody.appendChild(row);
            });
        }
        
        // Export to Excel functionality
        exportExcelBtn.addEventListener('click', () => {
            // Create workbook
            const wb = XLSX.utils.book_new();
            
            // Add analysis summary data
            const purity = document.getElementById('purityValue').textContent;
            const badge = document.querySelector('.purity-badge').textContent;
            const recommendation = document.getElementById('recommendationText').textContent;
            
            const summaryData = [
                ['ThermoPure Genetic Analysis Report'],
                [],
                ['Sample ID', 'TOM-' + new Date().getTime()],
                ['Analysis Date', new Date().toLocaleDateString()],
                ['Genetic Purity', purity],
                ['Purity Rating', badge],
                ['Recommendation', recommendation],
                []
            ];
            
            // Add detailed analysis data
            const tableRows = [];
            const headerRow = ['Parameter', 'Value', 'Status'];
            tableRows.push(headerRow);
            
            const table = document.getElementById('analysisTableBody');
            for (let i = 0; i < table.rows.length; i++) {
                const row = table.rows[i];
                const rowData = [];
                for (let j = 0; j < row.cells.length; j++) {
                    rowData.push(row.cells[j].textContent);
                }
                tableRows.push(rowData);
            }
            
            // Combine all data
            const excelData = [...summaryData, ...tableRows];
            
            // Create worksheet
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            
            // Add to workbook
            XLSX.utils.book_append_sheet(wb, ws, 'Genetic Analysis');
            
            // Export to file
            XLSX.writeFile(wb, 'thermopure_analysis_report.xlsx');
            
            showNotification('Report exported successfully!', false);
        });
        
        // New analysis button
        newAnalysisBtn.addEventListener('click', () => {
            resultsSection.style.display = 'none';
            fileInput.value = '';
            window.scrollTo({ top: dropZone.offsetTop - 100, behavior: 'smooth' });
        });
    </script>
</body>
</html>